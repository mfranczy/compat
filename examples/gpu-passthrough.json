{
  "schemaVersion": "0.1.0.",
  "linux": {
    "5.15.0": {
      "vfio": {
        "kernelConfiguration": {
          "CONFIG_VFIO": "m",
          "CONFIG_VFIO_IOMMU_TYPE1": "m",
          "CONFIG_VFIO_MDEV": "m",
          "CONFIG_VFIO_MDEV_DEVICE": "m",
          "CONFIG_VFIO_PCI": "m"
        },
        "kernelModules": {
          "vfio": {},
          "vfio_iommu_type1": {},
          "vfio-pci": {}
        }
      },
      "cpu": {
        "oneof": {
          "intel": {
            "hardware": {"cpu": ["GenuineIntel"]},
            "kernelCmdline": {
              "intel_iommu": "on"
            }
          },
          "amd": {
            "hardware": {"cpu": ["AuthenticAMD"]}
          }
        }
      },
      "gpu": {
        "oneof": {
          "nvidia": {
            "hardware": {
              "pci": [
                "0380:10de"
              ]
            },
            "kernelConfiguration": {
              "CONFIG_HOTPLUG_PCI_PCIE": "y",
              "CONFIG_MODULES": "y",
              "CONFIG_MODULE_UNLOAD": "y",
              "CONFIG_PCI_MMCONFIG": "y",
              "CONFIG_DRM_NOUVEAU": "n"
            },
            "kernelDrivers": {
              "cuda-drivers": {
                "510.54": {}
              }
            }
          },
          "intel": {
            "hardware": {
              "pci": [
                "0380:8086"
              ]
            },
            "kernelConfiguration": {
              "CONFIG_DRM": "y",
              "CONFIG_DRM_I915": "y",
              "CONFIG_DRM_I915_USERPTR": "y",
              "CONFIG_DRM_I915_GVT": "m",
              "CONFIG_DRM_I915_GVT_KVMGT": "m"
            },
            "kernelModules": {
              "kvmgt": {
                "enable_gvt": "1"
              }
            }
          }
        }
      }
    }
  }
}


// TODO:
// 1. Simplify the tool
// - remove the parallelism
// 2. Finish the scanners
// - implement checks
// 3. Take the discussion to the working group